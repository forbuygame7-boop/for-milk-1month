<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>For Milk</title>
    <link rel="stylesheet" href="style.css">
    <script type="module" src="auth-guard.js"></script>
</head>
<body>

    <div id="auth-overlay" style="position:fixed; top:0; left:0; width:100%; height:100%; background:white; z-index:9999; display:flex; justify-content:center; align-items:center; flex-direction:column;">
        <h2 style="color:#ff4d4d;">üîí ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏∏‡∏ç‡πÅ‡∏à...</h2>
        <p>‡∏£‡∏≠‡πÅ‡∏õ‡πä‡∏ö‡∏ô‡∏∂‡∏á‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö</p>
    </div>

    <div class="container">
        <h1 id="headline">Loading...</h1>
        
        <div class="timer-box">
            <p>‡πÄ‡∏£‡∏≤‡∏Ñ‡∏ö‡∏Å‡∏±‡∏ô‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß:</p>
            <h2 id="timer">0 ‡∏ß‡∏±‡∏ô 0 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á</h2>
        </div>

        <div class="interactive-area">
            <button id="heartButton" class="heart-btn">‚ù§Ô∏è ‡∏Å‡∏î‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡∏à‡∏¥</button>
            <p id="messageDisplay" class="fade-in">...</p>
        </div>

        
        
        <footer id="footerText"></footer>
        
        <div style="margin-top: 25px; display: flex; flex-direction: column; gap: 15px;">
            <a href="letter.html" style="text-decoration: none; color: #ff4d4d; border: 1px solid #ff4d4d; padding: 10px 20px; border-radius: 20px; display: inline-block;">
                ‚úâÔ∏è ‡πÄ‡∏õ‡∏¥‡∏î‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏•‡∏±‡∏ö (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏°‡∏¥‡πâ‡∏ß)
            </a>
            
            <button id="galleryBtn" style="background: #ff4d4d; color: white; border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer; font-family: 'Sarabun', sans-serif; font-size: 1rem; border: 1px solid #ff4d4d;">
                üì∏ ‡∏î‡∏π‡∏£‡∏π‡∏õ‡∏Ñ‡∏π‡πà‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤
            </button>

            <button id="missionBtn" style="background: #28a745; color: white; border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer; font-family: 'Sarabun', sans-serif; font-size: 1rem; border: 1px solid #28a745; display: flex; align-items: center; justify-content: center; gap: 5px;">
                üöÄ ‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏ñ‡∏±‡∏î‡πÑ‡∏õ
            </button>

            <a id="timelineBtn" href="timeline.html" style="text-decoration: none; display: none; background: #a55eea; color: white; padding: 10px 20px; border-radius: 20px; margin-top: 10px; width: fit-content; margin-left: auto; margin-right: auto;">
                ‚è≥ ‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡∏£‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤
            </a>

            <a id="valentineBtn" href="valentines.html" style="text-decoration: none; display: none; background: linear-gradient(45deg, #ff9ff3, #feca57); color: white; padding: 12px 25px; border-radius: 50px; margin-top: 15px; width: fit-content; margin-left: auto; margin-right: auto; box-shadow: 0 5px 15px rgba(255, 105, 180, 0.4); font-weight:bold; animation: floatBtn 3s infinite;">
                üîÆ ‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç‡∏û‡∏¥‡πÄ‡∏®‡∏©
            </a>
            
            <style>
                @keyframes floatBtn { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-5px); } }
            </style>
            
            <a id="adminBtn" href="admin.html" style="text-decoration: none; display: none; background: #333; color: white; padding: 10px 20px; border-radius: 20px; margin-top: 10px; width: fit-content; margin-left: auto; margin-right: auto; box-shadow: 0 4px 10px rgba(0,0,0,0.2);">
                ‚öôÔ∏è ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏ö (Admin)
            </a>
            
        </div>
    </div>

    <div id="heart-hunt-container"></div>
    <div id="flash-message-container"></div>

    <div id="cat-container">
        <div id="naughty-cat-body">
            <div class="cat-ear left"></div>
            <div class="cat-ear right"></div>
            <div class="cat-eye left"></div>
            <div class="cat-eye right"></div>
            <div class="cat-nose"></div>
            <div class="cat-tail"></div>
            <div class="cat-leg front"></div>
            <div class="cat-leg back"></div>
        </div>
        <div id="cat-speech" class="hidden">‡∏´‡πâ‡∏≤‡∏°‡∏à‡∏±‡∏ö! üòº</div>
    </div>

    <div id="mission-modal" class="modal hidden">
        <div class="modal-content" style="background: linear-gradient(to bottom, #e8f5e9, #ffffff);">
            <span id="closeMission" class="close-btn">&times;</span>
            <h2 style="color: #2e7d32;">üöÄ ‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤</h2>
            <p style="font-size: 14px; color: #666;">‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏°‡∏µ‡πÑ‡∏ß‡πâ‡∏û‡∏∏‡πà‡∏á‡∏ä‡∏ô... ‡πÅ‡∏ï‡πà‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏°‡∏µ‡πÑ‡∏ß‡πâ‡∏ä‡∏ô‡πÄ‡∏ò‡∏≠ ‡∏Æ‡∏¥‡πâ‡∏ß‡∏ß~</p>
            <div id="mission-grid" class="mission-container">
                <p>Loading...</p>
            </div>
        </div>
    </div>
    
    <div id="gallery-modal" class="modal hidden">
        <div class="modal-content">
            <span id="closeGallery" class="close-btn">&times;</span>
            <h2>üì∏ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤</h2>
            
            <div class="polaroid-grid">
                <p style="text-align:center; color:#999;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏à‡∏≤‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥...</p>
            </div>
        </div>
    </div>

    <div id="music-widget" class="music-widget">
        <div class="vinyl-record" onclick="toggleMusic()">
            <img id="music-cover" src="https://static.vecteezy.com/system/resources/previews/009/428/325/non_2x/3d-social-media-icons-music-free-png.png" alt="Music">
        </div>
        <div class="music-controls">
            <div class="song-info">
                <span id="song-name">üéµ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏û‡∏•‡∏á...</span>
            </div>
        </div>
        <div id="youtube-player-container">
            <div id="youtube-player"></div>
        </div>
    </div>

    <style>
        .music-widget {
            position: fixed; bottom: 20px; left: 20px; z-index: 9999;
            display: flex; align-items: center; gap: 10px;
            font-family: 'Sarabun', sans-serif;
        }
        .vinyl-record {
            width: 60px; height: 60px; background: #333;
            border-radius: 50%; border: 4px solid #fff;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3); cursor: pointer;
            position: relative; display: flex;
            justify-content: center; align-items: center;
            transition: transform 0.2s; animation: none;
        }
        .vinyl-record:hover { transform: scale(1.1); }
        .vinyl-record img { width: 100%; height: 100%; border-radius: 50%; object-fit: cover; }
        .spinning { animation: spin 3s linear infinite !important; }
        @keyframes spin { 100% { transform: rotate(360deg); } }
        .music-controls {
            background: rgba(255, 255, 255, 0.9); padding: 8px 15px;
            border-radius: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            max-width: 150px; white-space: nowrap; overflow: hidden; display: none;
        }
        .song-info span {
            display: inline-block; animation: marquee 5s linear infinite;
            color: #ff4d4d; font-weight: bold; font-size: 14px;
        }
        @keyframes marquee { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }
        #youtube-player-container {
            position: fixed; top: 0; left: 0; width: 1px; height: 1px; opacity: 0; pointer-events: none; z-index: -100; visibility: hidden;
        }
    </style>

    <script>
        const YOUTUBE_VIDEO_ID = "qngCJf9V6g8"; 
        const SONG_NAME = "üéµ ‡πÄ‡∏û‡∏•‡∏á: ‡∏£‡∏ß‡∏°‡πÄ‡∏û‡∏•‡∏á‡∏£‡∏±‡∏Å"; 

        let player;
        let isPlaying = false;
        const vinyl = document.querySelector('.vinyl-record');
        const info = document.querySelector('.music-controls');
        const nameLabel = document.getElementById('song-name');

        var tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        function onYouTubeIframeAPIReady() {
            player = new YT.Player('youtube-player', {
                height: '200', width: '200', videoId: YOUTUBE_VIDEO_ID,
                playerVars: { 'playsinline': 1, 'controls': 0, 'loop': 1, 'playlist': YOUTUBE_VIDEO_ID },
                events: { 'onReady': onPlayerReady }
            });
        }
        function onPlayerReady(event) {
            nameLabel.innerText = SONG_NAME;
            event.target.setVolume(70);
        }
        function toggleMusic() {
            if (!player || !player.playVideo) return;
            if (isPlaying) {
                player.pauseVideo();
                vinyl.classList.remove('spinning');
                info.style.display = 'none';
            } else {
                player.playVideo();
                vinyl.classList.add('spinning');
                info.style.display = 'block';
            }
            isPlaying = !isPlaying;
        }
        setTimeout(() => {
            const heartBtn = document.getElementById('heartButton');
            if(heartBtn) heartBtn.addEventListener('click', () => { if(!isPlaying && player) toggleMusic(); });
        }, 1000);
    </script>

    <script>
    // ‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à
    window.renderMissions = function() {
        const grid = document.getElementById('mission-grid');
        const missions = window.CONFIG.missions || [];
        if (!grid) return;
        grid.innerHTML = ''; 
        missions.sort((a, b) => new Date(a.date) - new Date(b.date));
        let showCount = 0; 
        missions.forEach(mission => {
            const timeLeft = calculateTimeLeft(mission.date);
            if (timeLeft.days > 30 || (timeLeft.days === 0 && timeLeft.hours === 0)) return; 
            showCount++; 
            const card = document.createElement('div');
            card.className = 'mission-card';
            card.innerHTML = `
                <div class="m-icon">${mission.icon}</div>
                <div class="m-info">
                    <h3>${mission.title}</h3>
                    <p>‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢: ${formatDate(mission.date)}</p>
                </div>
                <div class="m-countdown">
                    ${timeLeft.days} ‡∏ß‡∏±‡∏ô
                    <span>${timeLeft.hours} ‡∏ä‡∏°.</span>
                </div>`;
            grid.appendChild(card);
        });
        if (showCount === 0) grid.innerHTML = '<p style="text-align:center; width:100%; color:#999; margin-top:20px;">üéâ ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡πÄ‡∏£‡πá‡∏ß‡πÜ ‡∏ô‡∏µ‡πâ‡∏à‡πâ‡∏≤ (‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô‡∏¢‡∏≤‡∏ß‡πÑ‡∏õ!)</p>';
    };

    function calculateTimeLeft(targetDate) {
        const now = new Date();
        const target = new Date(targetDate);
        target.setHours(0,0,0,0); 
        const diff = target - now; 
        if (diff <= 0) return { days: 0, hours: 0 }; 
        const days = Math.floor(diff / (1000 * 60 * 60 * 24));
        const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        return { days, hours };
    }

    function formatDate(dateStr) {
        const d = new Date(dateStr);
        return `${d.getDate()}/${d.getMonth()+1}/${d.getFullYear()}`;
    }

    const missionModal = document.getElementById('mission-modal');
    const missionBtn = document.getElementById('missionBtn');
    const closeMission = document.getElementById('closeMission');

    if(missionBtn) {
        missionBtn.onclick = function() {
            missionModal.classList.remove('hidden'); 
            missionModal.classList.add('show');      
            renderMissions(); 
        }
    }
    if(closeMission) {
        closeMission.onclick = function() {
            missionModal.classList.add('hidden');
            missionModal.classList.remove('show');
        }
    }
    window.addEventListener('click', function(event) {
        if (event.target == missionModal) missionModal.classList.add('hidden');
    });
    </script>
    
    <script type="module" src="config.js"></script> 
    <script src="brain.js"></script> 
    <script type="module" src="script.js"></script> 
    <script type="module" src="chat-core.js"></script>

</body>
</html>


